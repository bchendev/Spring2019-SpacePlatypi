<!--
Copyright 2019 Google Inc.
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
    http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<!DOCTYPE html>
<html>
  <head>
    <title>User Page</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/user-page.css">
    <script src="https://cdn.ckeditor.com/ckeditor5/12.0.0/classic/ckeditor.js"></script>   
    <script src="/js/user-page-loader.js"></script>
    <style>
    #floating-panel {
        position: absolute;
        top: 7px;
        left: 15.2%;
        z-index: 5;
        background-color: #fff;
        padding: 3px;
        border: 1px solid #999;
        text-align: center;
        font-family: 'Roboto','sans-serif';
        line-height: 15px;
        width: 210px;
    }
    #map{
      width: 300px;
      height: 250px;
    }
  </style>
    </head>

    <body onload="buildUI();">

      <nav class="nav d-flex justify-content-between" style="padding: 15px 15px 0px 15px;" id="navigation">
        <li><a href="/"><img src="/images/logo.jpg" width="125" height="50" alt=""></a></li>
        <form action="/search" method="POST" class="form-inline my-2 my-lg-0">
          <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
      </nav>

     <hr>

      <div class="row">    
      <div class="col-2 px-0">
      <div class="container" style="margin: 20px; width: 100%;">
        <img src="/images/propic.jpg" class="rounded-circle mx-auto d-block" style="width: 90%; height: 90%;" alt="Profile Pic">
       </div> 
       <div class="container">    
    <form style="padding: 20px"> Upload Profile Picture <input type="file" name="image"></form>
      </div>
    <div class="container" style="margin: 25px">
       <form action="/about" method="POST">
        <div class="form-group">
          <label for="inputHandle">Handle</label>
          <input type="text" class="form-control" id="inputHandle" placeholder="Handle">
         </div>
         <div class="form-group">
          <label for="inputEmail">Email</label>
          <input type="email" class="form-control" id="inputEmail" aria-describedby="emailhelp" placeholder="Email">
        </div>
        <div class="form-group">
          <label for="inputPhone">Phone Number</label>
          <input type="text" class="form-control" id="inputPhone" placeholder="Phone Number">
         </div>
         <div class="form-group">
          <label for="inputAddress">Location</label>
          <input type="text" class="form-control" id="Address" placeholder="Address">
         </div>
        <button type="submit" class="btn btn-primary" id="submit-form">Submit</button>
      </form>
    </div>
      </div>
      <div class="col px-0">
        <h1 id="page-title" class="container">User Page</h1>

  <hr class="container">

        <div class="container">
          <h4>About Me</h4>
          <div id="about-me-container" style="margin-bottom: 20px">Loading...</div>
          <div id="about-me-form" class="hidden" style="margin: 0px 20px 20px 0px">
            <form action="/about" method="POST">
            <textarea name="about-me" id="about-me-input" placeholder="about me" rows=4 required></textarea>
            <br/>
            <input type="submit" value="Submit"> 
              <script>
                ClassicEditor
                  .create(document.querySelector( '#about-me-input' ),{
                  removePlugins: [ 'BlockQuote '],
              // Image upload feature to be incorporated with image project
                    toolbar: [ 'heading', '|', 'bold', 'italic', 'link', 'bulletedList', 'numberedList', 'imageUpload', 'undo', 'redo' ],
                    heading: {
                    options: [
                  { model: 'paragraph', title: 'Paragraph', class: 'ck-heading_paragraph' },
                        { model: 'heading1', view: 'h1', title: 'Title', class: 'ck-heading_heading1' },
                        { model: 'heading2', view: 'h2', title: 'Heading', class: 'ck-heading_heading2' },
                  { model: 'heading3', view: 'h3', title: 'Subheading', class: 'ck-heading_heading3' } 
                      ]
                    } 
                  } )
                  .then( editor => { console.log( editor ); })
                  .catch( error => { console.log( error ); });
              </script> 
            </form>
          </div>
        </div>
        <div class="container"> 
          <form id="message-form" action="/messages" method="POST" class="hidden" style="margin: 0px 20px 20px 0px">
            <textarea name="text" id="message-input" placeholder="new message" rows=4 required></textarea>
            <br/>
            <input type="submit" value="Submit"> 
              <script>
                ClassicEditor
                  .create(document.querySelector( '#message-input' ), {
                  removePlugins: [ 'blockQuote' ],
            // Image upload feature to be incorporated with image project
                  toolbar: [ 'heading', '|', 'bold', 'italic', 'link', 'bulletedList', 'numberedList', 'imageUpload', 'undo', 'redo'  ],
                  heading: {
                    options: [
                { model: 'paragraph', title: 'Paragraph', class: 'ck-heading_paragraph' },
                { model: 'heading1', view: 'h1', title: 'Title', class: 'ck-heading_heading1' },
                { model: 'heading2', view: 'h2', title: 'Heading', class: 'ck-heading_heading2' },
                { model: 'heading3', view: 'h3', title: 'Subheading', class: 'ck-heading_heading3' } 
              ]
                  }
                } )
                .then( editor => { console.log( editor ); })
                .catch( error => { console.log( error ); });
            </script> 
          </form>
        
        <div id="message-container">Loading...</div>

      </div>
      <div class="container">
        <div class="row container">
          <div class="col px-0">
            <h4 style="margin-bottom: 20px;"> Location </h4>
            <h4>Map</h4>
            <div class="container" style="margin: 20px; width: 100%;">
       
            <div id="map" onload="geocodeMap();">
              <script>
              	function geocodeMap() {
				  var map = new google.maps.Map(document.getElementById('map'), {
				  zoom: 8,
				  center: {lat: -34.397, lng: 150.644}
				  });
				  var geocoder = new google.maps.Geocoder();

				  document.getElementById('submit-form').addEventListener('click', function() {
				  geocodeAddress(geocoder, map);
				  });
				}

				function geocodeAddress(geocoder, resultsMap) {
				  var address = document.getElementById('Address').value;
				  geocoder.geocode({'address': address}, function(results, status) {
				    if (status === 'OK') {
				      resultsMap.setCenter(results[0].geometry.location);
				      var marker = new google.maps.Marker({
				      map: resultsMap,
				      position: results[0].geometry.location
				      });

				      var formattedAddress = results[0].formatted_address;
				      var infoWindow = new google.maps.InfoWindow({
				      content: formattedAddress
				      });
				      marker.addListener('click', () => {
				        infoWindow.open(map, marker);
				      });
				    } else {
				        alert('Geocode was not successful for the following reason: ' + status);
				      }
				  });
				}
              </script>
            </div>
            
              <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVU50aOCT7FRl8BZppVuXuZ05Wa41O0M4&callback=geocodeMap"></script>
            </div> 
          </div>
          <div class="col px-0">
            <h4> Groups </h4>
          </div>
        </div>
      </div>
    </div>
  </div>
  </body>  
</html>